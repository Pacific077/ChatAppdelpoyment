(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{176:function(e,t,r){},217:function(e){e.exports=JSON.parse('{"v":"5.5.2","fr":60,"ip":0,"op":104,"w":84,"h":40,"nm":"Typing-Indicator","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Oval 3","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.643],"y":[1]},"o":{"x":[1],"y":[0]},"t":18,"s":[35],"e":[100]},{"i":{"x":[0.099],"y":[1]},"o":{"x":[0.129],"y":[0]},"t":33,"s":[100],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":65,"s":[35],"e":[35]},{"t":71}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[61,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":18,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.032,0.032,0.667],"y":[1,1,1]},"o":{"x":[0.217,0.217,0.333],"y":[0,0,0]},"t":33,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":65,"s":[100,100,100],"e":[100,100,100]},{"t":71}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 3","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Oval 2","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[1],"y":[0]},"t":9,"s":[35],"e":[98]},{"i":{"x":[0.023],"y":[1]},"o":{"x":[0.179],"y":[0]},"t":24,"s":[98],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":56,"s":[35],"e":[35]},{"t":62}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[41,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.654,0.654,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":9,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.11,0.11,0.667],"y":[1,1,1]},"o":{"x":[0.205,0.205,0.333],"y":[0,0,0]},"t":24,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":56,"s":[100,100,100],"e":[100,100,100]},{"t":62}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 2","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Oval 1","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[1],"y":[0]},"t":0,"s":[35],"e":[100]},{"i":{"x":[0.067],"y":[1]},"o":{"x":[0.125],"y":[0]},"t":15,"s":[100],"e":[35]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":47,"s":[35],"e":[35]},{"t":53}],"ix":11,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[21,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.673,0.673,0.667],"y":[1,1,1]},"o":{"x":[1,1,0.333],"y":[0,0,0]},"t":0,"s":[100,100,100],"e":[140,140,100]},{"i":{"x":[0.049,0.049,0.667],"y":[1,1,1]},"o":{"x":[0.198,0.198,0.333],"y":[0,0,0]},"t":15,"s":[140,140,100],"e":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":47,"s":[100,100,100],"e":[100,100,100]},{"t":53}],"ix":6,"x":"var $bm_rt;\\n$bm_rt = loopOut(\'cycle\', 0);"}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[12,12],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.847000002861,0.847000002861,0.847000002861,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Oval 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"BG","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[42,20,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[-42,-20],[42,-20],[42,20],[-42,20]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"rd","nm":"Round Corners 1","r":{"a":0,"k":20,"ix":1},"ix":2,"mn":"ADBE Vector Filter - RC","hd":false},{"ty":"fl","c":{"a":0,"k":[0.96078401804,0.96078401804,0.96078401804,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"BG","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":3600,"st":0,"bm":0}],"markers":[]}')},242:function(e,t,r){},243:function(e,t,r){},348:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r(55),s=r.n(n),c=(r(242),r(243),r(4)),i=r(371),o=r(372),l=r(373),d=r(400),u=r(14),b=r(6),j=r.n(b),h=r(10),p=r(223),x=r(104),O=r(367),f=r(399),g=r(368),m=r(369),v=r(398),y=r(17),k=r.n(y),C=r(391),w=r(1),S=Object(a.createContext)(),_=function(){return Object(a.useContext)(S)},E=function(e){var t=e.children,r=Object(a.useState)(),n=Object(c.a)(r,2),s=n[0],i=n[1],o=Object(a.useState)(),l=Object(c.a)(o,2),d=l[0],b=l[1],j=Object(a.useState)([]),h=Object(c.a)(j,2),p=h[0],x=h[1],O=Object(a.useState)(),f=Object(c.a)(O,2),g=f[0],m=f[1],v=Object(u.useHistory)();return Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userInfo"));b(e),e||v.push("/")}),[v]),Object(w.jsx)(S.Provider,{value:{selectedChat:s,setSelectedChat:i,user:d,setUser:b,notification:p,setNotification:x,chats:g,setChats:m},children:t})},A=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),r=t[0],n=t[1],s=Object(C.a)(),i=Object(a.useState)(),o=Object(c.a)(i,2),l=o[0],d=o[1],b=Object(a.useState)(),y=Object(c.a)(b,2),S=y[0],E=y[1],A=Object(a.useState)(!1),F=Object(c.a)(A,2),B=F[0],z=F[1],I=Object(u.useHistory)(),R=_().setUser,N=function(){var e=Object(h.a)(j.a.mark((function e(){var t,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z(!0),l&&S){e.next=5;break}return s({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),z(!1),e.abrupt("return");case 5:return e.prev=5,t={headers:{"Content-type":"application/json"}},e.next=9,k.a.post("/api/user/login",{email:l,password:S},t);case 9:r=e.sent,a=r.data,s({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),R(a),localStorage.setItem("userInfo",JSON.stringify(a)),z(!1),I.push("/chats"),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),s({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),z(!1);case 22:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(v.b,{spacing:"10px",color:"white",children:[Object(w.jsxs)(x.a,{id:"email",isRequired:!0,children:[Object(w.jsx)(O.a,{children:"Email Address"}),Object(w.jsx)(f.a,{value:l,type:"email",placeholder:"Enter Your Email Address",onChange:function(e){return d(e.target.value)},borderColor:"gray.300",focusBorderColor:"gray.400"})]}),Object(w.jsxs)(x.a,{id:"password",isRequired:!0,children:[Object(w.jsx)(O.a,{children:"Password"}),Object(w.jsxs)(g.a,{size:"md",children:[Object(w.jsx)(f.a,{value:S,onChange:function(e){return E(e.target.value)},type:r?"text":"password",placeholder:"Enter password",focusBorderColor:"gray.400"}),Object(w.jsx)(m.a,{width:"4.5rem",children:Object(w.jsx)(p.a,{bg:"gray.700",_hover:{bg:"gray.700"},h:"1.75rem",_focus:"none",size:"sm",onClick:function(){return n(!r)},children:r?"Hide":"Show"})})]})]}),Object(w.jsx)(p.a,{bg:"gray.500",width:"100%",style:{marginTop:15},onClick:N,isLoading:B,_focus:"none",focusBorderColor:"gray.500",children:"Login"}),Object(w.jsx)(p.a,{variant:"solid",colorScheme:"red",width:"100%",_focus:"none",onClick:function(){d("guest@example.com"),E("123456")},children:"Get Guest User Credentials"})]})},F=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),r=t[0],n=t[1],s=function(){return n(!r)},i=Object(C.a)(),o=(Object(u.useHistory)(),Object(a.useState)()),l=Object(c.a)(o,2),d=l[0],b=l[1],y=Object(a.useState)(),S=Object(c.a)(y,2),_=S[0],E=S[1],A=Object(a.useState)(),F=Object(c.a)(A,2),B=F[0],z=F[1],I=Object(a.useState)(),R=Object(c.a)(I,2),N=R[0],D=R[1],M=Object(a.useState)(),L=Object(c.a)(M,2),P=L[0],G=L[1],T=Object(a.useState)(!1),W=Object(c.a)(T,2),V=W[0],U=W[1],J=function(){var e=Object(h.a)(j.a.mark((function e(){var t,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U(!0),d&&_&&N&&B){e.next=5;break}return i({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),U(!1),e.abrupt("return");case 5:if(N===B){e.next=8;break}return i({title:"Passwords Do Not Match",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 8:return console.log(d,_,N,P),e.prev=9,t={headers:{"Content-type":"application/json"}},e.next=13,k.a.post("/api/user",{name:d,email:_,password:N,pic:P},t);case 13:r=e.sent,console.log("response",r.data),i({title:"Registration Successful!! Please login ",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(r.data)),U(!1),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(9),i({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),U(!1);case 24:case"end":return e.stop()}}),e,null,[[9,20]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(v.b,{spacing:"5px",color:"white",children:[Object(w.jsxs)(x.a,{id:"first-name",isRequired:!0,children:[Object(w.jsx)(O.a,{children:"Name"}),Object(w.jsx)(f.a,{placeholder:"Enter Your Name",focusBorderColor:"gray.400",onChange:function(e){return b(e.target.value)}})]}),Object(w.jsxs)(x.a,{id:"email",isRequired:!0,children:[Object(w.jsx)(O.a,{children:"Email Address"}),Object(w.jsx)(f.a,{type:"email",focusBorderColor:"gray.400",placeholder:"Enter Your Email Address",onChange:function(e){return E(e.target.value)}})]}),Object(w.jsxs)(x.a,{id:"password",isRequired:!0,children:[Object(w.jsx)(O.a,{children:"Password"}),Object(w.jsxs)(g.a,{size:"md",children:[Object(w.jsx)(f.a,{type:r?"text":"password",placeholder:"Enter Password",focusBorderColor:"gray.400",onChange:function(e){return D(e.target.value)}}),Object(w.jsx)(m.a,{width:"4.5rem",children:Object(w.jsx)(p.a,{h:"1.75rem",size:"sm",bg:"gray.700",_hover:{bg:"gray.700"},_focus:"none",onClick:s,children:r?"Hide":"Show"})})]})]}),Object(w.jsxs)(x.a,{id:"password",isRequired:!0,children:[Object(w.jsx)(O.a,{children:"Confirm Password"}),Object(w.jsxs)(g.a,{size:"md",children:[Object(w.jsx)(f.a,{type:r?"text":"password",placeholder:"Confirm password",focusBorderColor:"gray.400",onChange:function(e){return z(e.target.value)}}),Object(w.jsx)(m.a,{width:"4.5rem",children:Object(w.jsx)(p.a,{h:"1.75rem",size:"sm",bg:"gray.700",_hover:{bg:"gray.700"},_focus:"none",onClick:s,children:r?"Hide":"Show"})})]})]}),Object(w.jsxs)(x.a,{id:"pic",children:[Object(w.jsx)(O.a,{children:"Upload your Picture"}),Object(w.jsx)(f.a,{type:"file",p:1.5,accept:"image/*",focusBorderColor:"gray.400",onChange:function(e){return function(e){if(U(!0),void 0!==e){if(console.log(e),"image/jpeg"!==e.type&&"image/png"!==e.type)return i({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void U(!1);var t=new FormData;t.append("file",e),t.append("upload_preset","chat-app"),t.append("cloud_name","piyushproj"),fetch("https://api.cloudinary.com/v1_1/piyushproj/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){G(e.url.toString()),console.log(e.url.toString()),U(!1)})).catch((function(e){console.log(e),U(!1)}))}else i({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})}(e.target.files[0])}})]}),Object(w.jsx)(p.a,{bg:"gray.500",_hover:{bg:"gray.400"},_focus:"none",width:"100%",style:{marginTop:15},onClick:J,isLoading:V,focusBorderColor:"gray.400",children:"Sign Up"})]})};var B,z,I=function(){var e=Object(u.useHistory)(),t=Object(a.useState)(0),r=Object(c.a)(t,2),n=r[0];return r[1],Object(a.useEffect)((function(){JSON.parse(localStorage.getItem("userInfo"))&&e.push("/chats")}),[e]),Object(w.jsxs)(i.a,{className:"ddfd",maxW:"xl",centerContent:!0,children:[Object(w.jsx)(o.a,{d:"flex",justifyContent:"center",p:3,bg:"gray.600",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px",borderColor:"gray.800",textColor:"white",fontWeight:"bold ",children:Object(w.jsx)(l.a,{fontSize:"4xl",fontFamily:"cursive",bg:"",children:"Chat-Buds"})}),Object(w.jsx)(o.a,{bg:"gray.700",w:"100%",p:4,borderRadius:"lg",borderWidth:"1px",borderColor:"blackAlpha.500",children:Object(w.jsxs)(d.e,{isFitted:!0,variant:"soft-rounded",children:[Object(w.jsxs)(d.b,{mb:"1em",children:[Object(w.jsx)(d.a,{_focus:"none",bg:0===n?"gray.500":"gray.400",color:"white",_selected:{bg:"gray.400",color:"white"},children:"Login"}),Object(w.jsx)(d.a,{_focus:"none",bg:1===n?"gray.400":"gray.500",color:"white",_selected:{bg:"gray.400",color:"white"},children:"Sign Up"})]}),Object(w.jsxs)(d.d,{children:[Object(w.jsxs)(d.c,{children:["+",Object(w.jsx)(A,{})]}),Object(w.jsx)(d.c,{children:Object(w.jsx)(F,{})})]})]})})]})},R=(r(176),r(9)),N=r(377),D=r(370),M=r(152),L=function(e,t,r,a){return r<e.length-1&&e[r+1].sender._id===t.sender._id&&e[r].sender._id!==a?33:r<e.length-1&&e[r+1].sender._id!==t.sender._id&&e[r].sender._id!==a||r===e.length-1&&e[r].sender._id!==a?0:"auto"},P=function(e,t,r,a){return r<e.length-1&&(e[r+1].sender._id!==t.sender._id||void 0===e[r+1].sender._id)&&e[r].sender._id!==a},G=function(e,t,r){return t===e.length-1&&e[e.length-1].sender._id!==r&&e[e.length-1].sender._id},T=function(e,t,r){return r>0&&e[r-1].sender._id===t.sender._id},W=function(e,t){var r;return(null===(r=t[0])||void 0===r?void 0:r._id)===(null===e||void 0===e?void 0:e._id)?t[1].name:t[0].name},V=r(385),U=r(386),J=r(378),$=r(376),H=r(54),q=r(379),Y=function(e){var t=e.user,r=e.children,a=Object($.a)(),n=a.isOpen,s=a.onOpen,c=a.onClose;return Object(w.jsxs)(w.Fragment,{children:[r?Object(w.jsx)("span",{onClick:s,children:r}):Object(w.jsx)(N.a,{d:{base:"flex"},icon:Object(w.jsx)(J.a,{}),onClick:s}),Object(w.jsxs)(H.a,{size:"lg",onClose:c,isOpen:n,isCentered:!0,children:[Object(w.jsx)(H.h,{}),Object(w.jsxs)(H.d,{h:"410px",className:"modalpage",bg:"gray.400",children:[Object(w.jsx)(H.g,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:t.name}),Object(w.jsx)(H.c,{}),Object(w.jsxs)(H.b,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[Object(w.jsx)(q.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),Object(w.jsxs)(l.a,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",children:["Email: ",t.email]})]}),Object(w.jsx)(H.f,{children:Object(w.jsx)(p.a,{bg:"gray.700",color:"whiteAlpha.800",_hover:{bg:"gray.600"},_focus:"none",onClick:c,children:"Close"})})]})]})]})},K=r(380),Q=r(395),X=r(215),Z=function(e){var t=e.messages,r=_().user;return Object(w.jsx)(X.a,{children:t&&t.map((function(e,a){return Object(w.jsxs)("div",{style:{display:"flex"},children:[(P(t,e,a,r._id)||G(t,a,r._id))&&Object(w.jsx)(Q.a,{label:e.sender.name,placement:"bottom-start",hasArrow:!0,children:Object(w.jsx)(K.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:e.sender.pic})}),Object(w.jsx)("span",{style:{backgroundColor:"".concat(e.sender._id===r._id?"#BEE3F8":"#B9F5D0"),marginLeft:L(t,e,a,r._id),marginTop:T(t,e,a,r._id)?3:10,borderRadius:"20px",padding:"5px 15px",maxWidth:"75%"},children:e.content})]},e._id)}))})},ee=r(216),te=r.n(ee),re=r(217),ae=r(127),ne=r(218),se=r.n(ne),ce=r(382),ie=r(381),oe=function(e){var t=e.user,r=e.handleFunction,a=e.admin;return Object(w.jsxs)(ie.a,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:r,children:[t.name,a===t._id&&Object(w.jsx)("span",{children:" (Admin)"}),Object(w.jsx)(ce.a,{pl:1})]})},le=function(e){var t=e.handleFunction,r=e.user;return console.log("users",r),Object(w.jsxs)(o.a,{onClick:t,cursor:"pointer",bg:"red",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(w.jsx)(K.a,{mr:2,size:"sm",cursor:"pointer",name:r.name,src:r.pic}),Object(w.jsxs)(o.a,{children:[Object(w.jsx)(l.a,{children:r.name}),Object(w.jsxs)(l.a,{fontSize:"xs",children:[Object(w.jsx)("b",{children:"Email : "}),r.email]})]})]})},de=function(e){var t=e.fetchMessages,r=e.fetchAgain,n=e.setFetchAgain,s=Object($.a)(),i=s.isOpen,l=s.onOpen,d=s.onClose,u=Object(a.useState)(),b=Object(c.a)(u,2),O=b[0],g=b[1],m=Object(a.useState)(""),v=Object(c.a)(m,2),y=v[0],S=v[1],E=Object(a.useState)([]),A=Object(c.a)(E,2),F=A[0],B=A[1],z=Object(a.useState)(!1),I=Object(c.a)(z,2),R=I[0],M=I[1],L=Object(a.useState)(!1),P=Object(c.a)(L,2),G=P[0],T=P[1],W=Object(C.a)(),V=_(),U=V.selectedChat,q=V.setSelectedChat,Y=V.user,K=function(){var e=Object(h.a)(j.a.mark((function e(t){var r,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,M(!0),r={headers:{Authorization:"Bearer ".concat(Y.token)}},e.next=8,k.a.get("/api/user?search=".concat(y),r);case 8:a=e.sent,n=a.data,console.log(n),M(!1),B(n),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),W({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),M(!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(h.a)(j.a.mark((function e(){var t,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,T(!0),t={headers:{Authorization:"Bearer ".concat(Y.token)}},e.next=7,k.a.put("/api/chat/rename",{chatId:U._id,chatName:O},t);case 7:a=e.sent,s=a.data,console.log(s._id),q(s),n(!r),T(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),W({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),T(!1);case 19:g("");case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(h.a)(j.a.mark((function e(t){var r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U.users.find((function(e){return e._id===t._id}))){e.next=3;break}return W({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(U.groupAdmin._id===Y._id){e.next=6;break}return W({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,M(!0),r={headers:{Authorization:"Bearer ".concat(Y.token)}},e.next=11,k.a.put("/api/chat/sendmail/".concat(U._id,"/").concat(t._id),{},r);case 11:200===(a=e.sent).status&&W({title:"Mail sent",description:"Request for grp join sent to user",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),console.log("resp",a),M(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),W({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),M(!1);case 21:g("");case 22:case"end":return e.stop()}}),e,null,[[6,17]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(h.a)(j.a.mark((function e(a){var s,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U.groupAdmin._id===Y._id||a._id===Y._id){e.next=3;break}return W({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,M(!0),s={headers:{Authorization:"Bearer ".concat(Y.token)}},e.next=8,k.a.put("/api/chat/groupremove",{chatId:U._id,userId:a._id},s);case 8:c=e.sent,i=c.data,a._id===Y._id?q():q(i),n(!r),t(),M(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),W({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),M(!1);case 20:g("");case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(N.a,{d:{base:"flex"},icon:Object(w.jsx)(J.a,{}),onClick:l}),Object(w.jsxs)(H.a,{onClose:d,isOpen:i,isCentered:!0,children:[Object(w.jsx)(H.h,{}),Object(w.jsxs)(H.d,{children:[Object(w.jsx)(H.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:U.chatName}),Object(w.jsx)(H.c,{}),Object(w.jsxs)(H.b,{d:"flex",flexDir:"column",alignItems:"center",children:[Object(w.jsx)(o.a,{w:"100%",d:"flex",flexWrap:"wrap",pb:3,children:U.users.map((function(e){return Object(w.jsx)(oe,{user:e,admin:U.groupAdmin,handleFunction:function(){return Z(e)}},e._id)}))}),Object(w.jsxs)(x.a,{d:"flex",children:[Object(w.jsx)(f.a,{placeholder:"Chat Name",mb:3,value:O,onChange:function(e){return g(e.target.value)}}),Object(w.jsx)(p.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:G,onClick:Q,children:"Update"})]}),Object(w.jsx)(x.a,{children:Object(w.jsx)(f.a,{placeholder:"Add User to group",mb:1,onChange:function(e){return K(e.target.value)}})}),R?Object(w.jsx)(D.a,{size:"lg"}):null===F||void 0===F?void 0:F.map((function(e){return Object(w.jsx)(le,{user:e,handleFunction:function(){return X(e)}},e._id)}))]}),Object(w.jsx)(H.f,{children:Object(w.jsx)(p.a,{onClick:function(){return Z(Y)},colorScheme:"red",children:"Leave Group"})})]})]})]})},ue=Object(a.createContext)(),be=r(383),je=r(384),he=function(e){var t=e.setMessages,r=e.messages,n=e.socket,s=Object(a.useState)(0),i=Object(c.a)(s,2),d=i[0],u=i[1],b=Object(a.useState)(0),x=Object(c.a)(b,2),O=x[0],g=x[1],m=Object(C.a)(),v=Object(a.useState)(""),y=Object(c.a)(v,2),S=y[0],E=y[1],A=Object(a.useState)(""),F=Object(c.a)(A,2),B=F[0],z=F[1],I=_(),N=I.selectedChat,D=I.user,L=Object(a.useContext)(ue).setScheduleFormVis,P=function(){var e=Object(h.a)(j.a.mark((function e(){var a,s,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m({title:"schedule!",description:"Message will be sent on time ",status:"success",duration:6e3,isClosable:!0}),L(!1),e.prev=2,a=S+"T"+d+":"+O+":00",console.log("time",a),s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(D.token)}},z(""),e.next=9,k.a.post("/api/message",{content:B,chatId:N,scheduledTime:a},s);case 9:c=e.sent,i=c.data,n.emit("new message",i),t([].concat(Object(R.a)(r),[i])),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),m({title:"Error!",description:"Invalid time ",status:"error",duration:6e3,isClosable:!0});case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(o.a,{boxSizing:"border-box",padding:"3vh",position:"absolute",boxShadow:"10px 10px 10px gray",right:"8vh",bgColor:"white",height:"52vh",width:"40vh",borderRadius:"20px",marginBottom:"0",children:[Object(w.jsxs)(o.a,{display:"flex",children:[Object(w.jsx)(M.a,{as:ae.a,height:"4vh",width:"4vh",color:"black",border:"2px solid black",borderRadius:"100%",backgroundColor:"white",marginLeft:"2vh",marginRight:"2vh"}),Object(w.jsx)(l.a,{children:"Schedule a Message"})]}),Object(w.jsx)(l.a,{marginTop:"2vh",marginLeft:"2vh",children:"Message"}),Object(w.jsx)(f.a,{onChange:function(e){z(e.target.value)},marginTop:"2vh",border:"2px solid black",placeholder:"Enter message "}),Object(w.jsx)(f.a,{type:"Date",onChange:function(e){E(e.target.value),console.log("date",e.target.value)},marginTop:"2vh"}),Object(w.jsxs)(o.a,{display:"flex",gridGap:"3.5vh",marginTop:"2vh",children:[Object(w.jsx)(o.a,{border:"2px solid black",boxShadow:"4px 4px 4px gray",height:"2vh",width:"2vh",position:"absolute",bgColor:"black",borderRadius:"100%",left:"47%",top:"60%"}),Object(w.jsx)(o.a,{border:"2px solid black",boxShadow:"4px 4px 4px gray",height:"2vh",width:"2vh",position:"absolute",bgColor:"black",borderRadius:"100%",left:"47%",top:"70%"}),Object(w.jsxs)(o.a,{border:"2px solid gray",borderRadius:"20px",height:"13vh",width:"12vh",marginLeft:"3vh",children:[Object(w.jsx)(l.a,{height:"75%",fontSize:"7vh",textAlign:"center",children:d}),Object(w.jsxs)(o.a,{display:"flex",justifyContent:"center",children:[Object(w.jsx)(be.a,{fontSize:"3vh",cursor:"pointer",onClick:function(){u(d+1<=23?d+1:0)}}),Object(w.jsx)(je.a,{cursor:"pointer",fontSize:"3vh",onClick:function(){u(d-1>=0?d-1:23)}})]})]}),Object(w.jsxs)(o.a,{border:"2px solid gray",borderRadius:"20px",height:"13vh",width:"12vh",children:[Object(w.jsx)(l.a,{height:"75%",fontSize:"7vh",textAlign:"center",children:O}),Object(w.jsxs)(o.a,{display:"flex",justifyContent:"center",children:[Object(w.jsx)(be.a,{fontSize:"3vh",onClick:function(){g(O+1<=59?O+1:0)},cursor:"pointer"}),Object(w.jsx)(je.a,{fontSize:"3vh",onClick:function(){g(O-1>=0?O-1:59)},cursor:"pointer"})]})]})]}),Object(w.jsx)(p.a,{onClick:function(){L(!1),console.log("u clicked cancel button")},colorScheme:"red",float:"right",marginTop:"2vh",children:"Cancel"}),Object(w.jsx)(p.a,{onClick:P,float:"right",marginRight:"2vh",colorScheme:"purple",marginTop:"2vh",children:"send"})]})},pe=r(219),xe=r(222),Oe=function(e){var t=e.fetchAgain,r=e.setFetchAgain,n=Object(a.useState)([]),s=Object(c.a)(n,2),i=s[0],d=s[1],u=Object(a.useState)(!1),b=Object(c.a)(u,2),p=b[0],O=b[1],g=Object(a.useState)(""),m=Object(c.a)(g,2),v=m[0],y=m[1],S=Object(a.useState)(!1),E=Object(c.a)(S,2),A=E[0],F=E[1],I=Object(a.useState)(!1),L=Object(c.a)(I,2),P=L[0],G=L[1],T=Object(a.useState)(!1),J=Object(c.a)(T,2),$=J[0],H=J[1],q=Object(a.useContext)(ue),K=q.ScheduleFormVis,Q=q.setScheduleFormVis,X=Object(a.useState)(!1),ee=Object(c.a)(X,2),ne=ee[0],ce=ee[1],ie=Object(C.a)(),oe={loop:!0,autoplay:!0,animationData:re,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},le=_(),be=le.selectedChat,je=le.setSelectedChat,Oe=le.user,fe=le.notification,ge=le.setNotification,me=function(){var e=Object(h.a)(j.a.mark((function e(){var t,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{Authorization:"Bearer ".concat(Oe.token)}},O(!0),e.next=7,k.a.get("/api/message/".concat(be._id),t);case 7:r=e.sent,a=r.data,d(a),O(!1),B.emit("join chat",be._id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),ie({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=Object(h.a)(j.a.mark((function e(t){var r,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!=t.key||!v){e.next=17;break}return B.emit("stop typing",be._id),e.prev=2,r={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Oe.token)}},y(""),e.next=7,k.a.post("/api/message",{content:v,chatId:be},r);case 7:a=e.sent,n=a.data,console.log("selectedChat",be),B.emit("new message",n),d([].concat(Object(R.a)(i),[n])),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),ie({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(h.a)(j.a.mark((function e(){var t,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Oe.token)}},y(""),e.next=5,k.a.post("/api/message",{content:v,chatId:be},t);case 5:r=e.sent,a=r.data,B.emit("new message",a),d([].concat(Object(R.a)(i),[a])),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),ie({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){(B=se()("http://localhost:5000")).emit("setup",Oe),B.on("connected",(function(){return F(!0)})),B.on("typing",(function(){return H(!0)})),B.on("stop typing",(function(){return H(!1)}))}),[]),Object(a.useEffect)((function(){me(),z=be}),[be]),Object(a.useEffect)((function(){B.on("message recieved",(function(e){z&&z._id===e.chat._id?d([].concat(Object(R.a)(i),[e])):fe.includes(e)||(ge([e].concat(Object(R.a)(fe))),r(!t))}))}));var ke,Ce,we=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=function(e){we.current&&!we.current.contains(e.target)&&ce(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[we]),Object(w.jsx)(w.Fragment,{children:be?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(l.a,{className:"chatHeader",fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",textColor:"white",fontWeight:"bold",fontStyle:"normal",fontFamily:"Work sans",d:"flex",justifyContent:{base:"space-between"},justifyItems:"center",alignItems:"center",children:[Object(w.jsx)(N.a,{className:"iconBut",color:"black",d:{base:"flex",md:"none"},icon:Object(w.jsx)(V.a,{}),onClick:function(){return je("")}}),i&&(be.isGroupChat?Object(w.jsxs)(w.Fragment,{children:[be.chatName.toUpperCase(),Object(w.jsx)(de,{fetchMessages:me,fetchAgain:t,setFetchAgain:r})]}):Object(w.jsxs)(w.Fragment,{children:[W(Oe,be.users),Object(w.jsx)(Y,{user:(ke=Oe,Ce=be.users,Ce[0]._id===ke._id?Ce[1]:Ce[0])})]}))]}),Object(w.jsxs)(o.a,{className:"chatwallpaper",d:"flex",flexDir:"column",justifyContent:"flex-end",p:3,w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[p?Object(w.jsx)(D.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):Object(w.jsx)("div",{className:"messages",children:Object(w.jsx)(Z,{messages:i})}),Object(w.jsxs)(x.a,{onKeyDown:ve,id:"first-name",isRequired:!0,mt:3,d:"flex",children:[$?Object(w.jsx)("div",{children:Object(w.jsx)(te.a,{options:oe,width:70,style:{marginBottom:15,marginLeft:0}})}):Object(w.jsx)(w.Fragment,{}),Object(w.jsxs)("div",{ref:we,style:{display:"flex",alignItems:"center",position:"relative"},children:[Object(w.jsx)("button",{className:"emoji-tray",onClick:function(){ce(!ne)},children:"\ud83d\ude0a"}),ne&&Object(w.jsx)("div",{style:{position:"absolute",bottom:"50px"},children:Object(w.jsx)(xe.a,{data:pe,preview:"none",onEmojiSelect:function(e){y((function(t){return t+e.native}))}})})]}),Object(w.jsx)(f.a,{variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message..",color:"white",value:v,onChange:function(e){if(y(e.target.value),A){P||(G(!0),B.emit("typing",be._id));var t=(new Date).getTime();setTimeout((function(){(new Date).getTime()-t>=3e3&&P&&(B.emit("stop typing",be._id),G(!1))}),3e3)}},focusBorderColor:"gray.400  "}),Object(w.jsx)(M.a,{cursor:"pointer",onClick:function(){Q(!0)},as:ae.a,height:"5vh",width:"5vh",color:"green",border:"2px solid black",borderRadius:"100%",backgroundColor:"white",marginLeft:"2vh",marginRight:"2vh"}),Object(w.jsx)("div",{className:"sendMessage",onClick:ye,children:Object(w.jsx)(U.a,{})})]}),K&&Object(w.jsx)(he,{socket:B,messages:i,setMessages:d})]})]}):Object(w.jsx)(o.a,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:Object(w.jsx)(l.a,{fontSize:"3xl",pb:3,fontFamily:"Work sans",children:"Click on a user to start chatting"})})})},fe=function(e){var t=e.fetchAgain,r=e.setFetchAgain,a=_().selectedChat;return Object(w.jsx)(o.a,{d:{base:a?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"black",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px",children:Object(w.jsx)(Oe,{fetchAgain:t,setFetchAgain:r})})},ge=r(387),me=r(393),ve=function(){return Object(w.jsxs)(v.a,{children:[Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"}),Object(w.jsx)(me.a,{height:"45px"})]})},ye=function(e){var t=e.children,r=Object($.a)(),n=r.isOpen,s=r.onOpen,i=r.onClose,l=Object(a.useState)(),d=Object(c.a)(l,2),u=d[0],b=d[1],O=Object(a.useState)([]),g=Object(c.a)(O,2),m=g[0],v=g[1],y=Object(a.useState)(""),S=Object(c.a)(y,2),E=S[0],A=S[1],F=Object(a.useState)([]),B=Object(c.a)(F,2),z=B[0],I=B[1],N=Object(a.useState)(!1),M=Object(c.a)(N,2),L=M[0],P=M[1],G=Object(C.a)(),T=_(),W=T.user,V=T.chats,U=T.setChats,J=function(){var e=Object(h.a)(j.a.mark((function e(t){var r,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,P(!0),r={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=8,k.a.get("/api/user?search=".concat(E),r);case 8:a=e.sent,n=a.data,console.log(n),P(!1),I(n),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),G({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(h.a)(j.a.mark((function e(){var t,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P(!0),u&&m){e.next=4;break}return G({title:"Please fill all the feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"}),e.abrupt("return");case 4:return e.prev=4,t={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=8,k.a.post("/api/chat/group",{name:u,users:JSON.stringify(m.map((function(e){return e._id})))},t);case 8:r=e.sent,a=r.data,U([a].concat(Object(R.a)(V))),i(),G({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),G({title:"Failed to Create the Chat!",description:e.t0.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 18:P(!1);case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("span",{onClick:s,children:t}),Object(w.jsxs)(H.a,{onClose:i,isOpen:n,isCentered:!0,children:[Object(w.jsx)(H.h,{}),Object(w.jsxs)(H.d,{children:[Object(w.jsx)(H.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:"Create Group Chat"}),L&&Object(w.jsx)(D.a,{margin:"auto",thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),Object(w.jsx)(H.c,{}),Object(w.jsxs)(H.b,{d:"flex",flexDir:"column",alignItems:"center",children:[Object(w.jsx)(x.a,{children:Object(w.jsx)(f.a,{placeholder:"Chat Name",mb:3,onChange:function(e){return b(e.target.value)}})}),Object(w.jsx)(x.a,{children:Object(w.jsx)(f.a,{placeholder:"Add Users eg: John, Piyush, Jane",mb:1,onChange:function(e){return J(e.target.value)}})}),Object(w.jsx)(o.a,{w:"100%",d:"flex",flexWrap:"wrap",children:m.map((function(e){return Object(w.jsx)(oe,{user:e,handleFunction:function(){return t=e,void v(m.filter((function(e){return e._id!==t._id})));var t}},e._id)}))}),L?Object(w.jsx)("div",{children:"Adding..."}):null===z||void 0===z?void 0:z.slice(0,4).map((function(e){return Object(w.jsx)(le,{user:e,handleFunction:function(){return t=e,void(m.includes(t)?G({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):v([].concat(Object(R.a)(m),[t])));var t}},e._id)}))]}),Object(w.jsx)(H.f,{children:Object(w.jsx)(p.a,{onClick:q,colorScheme:"blue",children:"Create Chat"})})]})]})]})},ke=function(e){var t=e.fetchAgain,r=Object(a.useState)(),n=Object(c.a)(r,2),s=n[0],i=n[1],d=_(),u=d.selectedChat,b=d.setSelectedChat,x=d.user,O=d.chats,f=d.setChats,g=Object(C.a)(),m=function(){var e=Object(h.a)(j.a.mark((function e(){var t,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={headers:{Authorization:"Bearer ".concat(x.token)}},e.next=4,k.a.get("/api/chat",t);case 4:r=e.sent,f(r.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){i(JSON.parse(localStorage.getItem("userInfo"))),m()}),[t]),Object(w.jsxs)(o.a,{className:"mychatdiv",d:{base:u?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px",children:[Object(w.jsxs)(o.a,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",d:"flex",w:"100%",justifyContent:"space-between",alignItems:"center",color:"white",children:["My Chats",Object(w.jsx)(ye,{children:Object(w.jsx)(p.a,{d:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:Object(w.jsx)(ge.a,{}),color:"blue",children:"New Group Chat"})})]}),Object(w.jsx)(o.a,{d:"flex",flexDir:"column",p:3,className:"innerMychat",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:O?Object(w.jsx)(v.a,{overflowY:"scroll",children:O.map((function(e){return Object(w.jsxs)(o.a,{onClick:function(){return b(e)},cursor:"pointer",bg:u===e?"#38B2AC":"#E8E8E8",color:u===e?"white":"black",px:3,py:2,borderRadius:"lg",children:[Object(w.jsx)(l.a,{children:e.isGroupChat?e.chatName:W(s,e.users)}),e.latestMessage&&Object(w.jsxs)(l.a,{fontSize:"xs",children:[Object(w.jsxs)("b",{children:[e.latestMessage.sender.name," : "]}),e.latestMessage.content.length>50?e.latestMessage.content.substring(0,51)+"...":e.latestMessage.content]})]},e._id)}))}):Object(w.jsx)(ve,{})})]})},Ce=r(394),we=r(402),Se=r(388),_e=r(126),Ee=r.n(_e);var Ae=function(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),r=t[0],n=t[1],s=Object(a.useState)([]),i=Object(c.a)(s,2),d=i[0],b=i[1],x=Object(a.useState)(!1),O=Object(c.a)(x,2),g=O[0],m=O[1],v=Object(a.useState)(!1),y=Object(c.a)(v,2),S=y[0],E=y[1],A=_(),F=A.setSelectedChat,B=A.user,z=A.notification,I=A.setNotification,N=A.chats,M=A.setChats,L=Object(C.a)(),P=Object($.a)(),G=P.isOpen,T=P.onOpen,V=P.onClose,U=Object(u.useHistory)(),J=function(){var e=Object(h.a)(j.a.mark((function e(){var t,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return L({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"}),e.abrupt("return");case 3:return e.prev=3,m(!0),t={headers:{Authorization:"Bearer ".concat(B.token)}},e.next=8,k.a.get("/api/user?search=".concat(r),t);case 8:a=e.sent,n=a.data,m(!1),console.log("data",n),b(n),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),L({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(h.a)(j.a.mark((function e(t){var r,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.prev=1,E(!0),r={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(B.token)}},e.next=6,k.a.post("/api/chat",{userId:t},r);case 6:a=e.sent,n=a.data,N.find((function(e){return e._id===n._id}))||M([n].concat(Object(R.a)(N))),F(n),E(!1),V(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),L({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(o.a,{d:"flex",justifyContent:"space-between",alignItems:"center",bg:"black",color:"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px",children:[Object(w.jsx)(Q.a,{label:"Search Users to chat",hasArrow:!0,placement:"bottom-end",children:Object(w.jsxs)(p.a,{variant:"ghost",onClick:T,_hover:{bg:"gray.700"},_focus:"none",children:[Object(w.jsx)("i",{className:"fas fa-search"}),Object(w.jsx)(l.a,{d:{base:"none",md:"flex"},px:4,children:"Search User"})]})}),Object(w.jsx)(l.a,{fontSize:"2xl",fontFamily:"cursive",children:"Chat-Buds"}),Object(w.jsxs)("div",{children:[Object(w.jsxs)(Ce.a,{children:[Object(w.jsxs)(Ce.b,{p:1,children:[Object(w.jsx)(Ee.a,{count:z.length,effect:_e.Effect.SCALE}),Object(w.jsx)(Se.a,{fontSize:"2xl",m:1})]}),Object(w.jsxs)(Ce.e,{pl:2,children:[!z.length&&"No New Messages",z.map((function(e){return Object(w.jsx)(Ce.d,{onClick:function(){F(e.chat),I(z.filter((function(t){return t!==e})))},children:e.chat.isGroupChat?"New Message in ".concat(e.chat.chatName):"New Message from ".concat(W(B,e.chat.users))},e._id)}))]})]}),Object(w.jsxs)(Ce.a,{children:[Object(w.jsx)(Ce.b,{as:p.a,bg:"gray.600",_hover:{bg:"gray.500"},rightIcon:Object(w.jsx)(je.a,{}),children:Object(w.jsx)(K.a,{size:"sm",cursor:"pointer",name:B.name,src:B.pic,color:"black"})}),Object(w.jsxs)(Ce.e,{bg:"gray.700",children:[Object(w.jsxs)(Y,{user:B,children:[Object(w.jsx)(Ce.d,{_hover:{bg:"gray.400"},children:"My Profile"})," "]}),Object(w.jsx)(Ce.c,{}),Object(w.jsx)(Ce.d,{_hover:{bg:"gray.400"},onClick:function(){localStorage.removeItem("userInfo"),U.push("/")},children:"Logout"})]})]})]})]}),Object(w.jsxs)(we.a,{placement:"left",onClose:V,isOpen:G,children:[Object(w.jsx)(H.h,{}),Object(w.jsxs)(we.b,{children:[Object(w.jsx)(H.g,{borderBottomWidth:"1px",bg:"gray.800",color:"white",children:"Search Users"}),Object(w.jsxs)(H.b,{className:"drawerBody",children:[Object(w.jsxs)(o.a,{d:"flex",pb:2,children:[Object(w.jsx)(f.a,{placeholder:"Search by name or email",color:"whiteAlpha.700",mr:2,value:r,onChange:function(e){return n(e.target.value)}}),Object(w.jsx)(p.a,{onClick:J,children:"Go"})]}),g?Object(w.jsx)(ve,{}):null===d||void 0===d?void 0:d.map((function(e){return Object(w.jsx)(le,{user:e,handleFunction:function(){return q(e._id)}},e._id)})),S&&Object(w.jsx)(D.a,{ml:"auto",d:"flex"})]})]})]})]})},Fe=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),r=t[0],n=t[1],s=_().user;return Object(w.jsxs)("div",{style:{width:"100%"},children:[s&&Object(w.jsx)(Ae,{}),Object(w.jsxs)(o.a,{d:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px",children:[s&&Object(w.jsx)(ke,{fetchAgain:r}),s&&Object(w.jsx)(fe,{fetchAgain:r,setFetchAgain:n})]})]})},Be=r(154),ze=function(){var e=Object(C.a)(),t=Object(Be.useHistory)(),r=Object(Be.useParams)(),a=r.chatId,n=r.userId,s=_().user,c=function(){var r=Object(h.a)(j.a.mark((function r(){var c,i;return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("I got clicked",a,n),r.prev=1,c={headers:{Authorization:"Bearer ".concat(s.token)}},r.next=5,k.a.put("/api/chat/groupadd/".concat(a,"/").concat(n),{},c);case 5:i=r.sent,console.log("resp",i),200===i.status&&e({title:"Added",description:"You were added to grp",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1),e({title:"Error",description:"Something went wrong",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 13:t.push("/");case 14:case"end":return r.stop()}}),r,null,[[1,10]])})));return function(){return r.apply(this,arguments)}}();return Object(w.jsx)(o.a,{border:"2px solid white",height:"38vh",borderRadius:"30px",width:"50vh",margin:"auto",bgColor:"white",children:Object(w.jsxs)(l.a,{textAlign:"center",marginTop:"4vh",fontSize:"xx-large",fontWeight:"600",textShadow:"4px 4px 4px gray",children:["Are you sure you want to join the group ?",Object(w.jsxs)(o.a,{marginTop:"8vh",display:"flex",gridGap:"3vh",justifyContent:"center",children:[Object(w.jsx)(p.a,{onClick:c,height:"6vh",width:"10vh",colorScheme:"green",children:"Join"}),Object(w.jsx)(p.a,{height:"6vh",width:"10vh",colorScheme:"red",children:"Reject"})]})]})})};var Ie=function(){return Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(u.Route,{path:"/",component:I,exact:!0}),Object(w.jsx)(u.Route,{path:"/chats",component:Fe}),Object(w.jsx)(u.Route,{path:"/joingrp/:chatId/:userId",component:ze})]})},Re=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,404)).then((function(t){var r=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,c=t.getTTFB;r(e),a(e),n(e),s(e),c(e)}))},Ne=r(392),De=r(90),Me=function(e){var t=e.children,r=Object(a.useState)(!1),n=Object(c.a)(r,2),s=n[0],i=n[1];return Object(w.jsx)(ue.Provider,{value:{ScheduleFormVis:s,setScheduleFormVis:i},children:t})};s.a.render(Object(w.jsx)(Ne.a,{children:Object(w.jsx)(De.a,{children:Object(w.jsx)(E,{children:Object(w.jsx)(Me,{children:Object(w.jsx)(Ie,{})})})})}),document.getElementById("root")),Re()}},[[348,1,2]]]);
//# sourceMappingURL=main.f82cdf81.chunk.js.map